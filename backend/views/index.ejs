<%- include('partials/header') %>

<main class="main-content">
    <div class="container">

        <% if (error) { %>
            <div class="alert alert-error">
                <i class="fas fa-exclamation-circle"></i>
                <span><%= error %></span>
                <button class="alert-close" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        <% } %>

        <% if (success) { %>
            <div class="alert alert-success">
                <i class="fas fa-check-circle"></i>
                <span><%= success %></span>
                <button class="alert-close" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        <% } %>

        <div class="add-todo-section">
            <h2><i class="fas fa-plus-circle"></i> Add Task</h2>
            <form action="/add" method="POST" id="addTodoForm" class="add-todo-form">
                <div class="form-group">
                    <input type="text" name="task" id="todoInput" placeholder="Enter your task..." class="todo-input" autocomplete="off" required>
                    <select name="priority" class="priority-select">
                        <option value="High">High Priority</option>
                        <option value="Medium" selected>Medium Priority</option>
                        <option value="Low">Low Priority</option>
                    </select>
                    <button type="submit" class="btn btn-primary"><i class="fas fa-plus"></i> Add Task</button>
                </div>
            </form>
        </div>

        <div class="filter-section">
            <h3><i class="fas fa-filter"></i> Filter Tasks</h3>
            <div class="filter-buttons">
                <a href="/filter?priority=All" class="btn-filter <%= filter === 'All' ? 'active' : '' %>">All Tasks</a>
                <a href="/filter?priority=High" class="btn-filter <%= filter === 'High' ? 'active' : '' %>"><span class="priority-badge high">High</span></a>
                <a href="/filter?priority=Medium" class="btn-filter <%= filter === 'Medium' ? 'active' : '' %>"><span class="priority-badge medium">Medium</span></a>
                <a href="/filter?priority=Low" class="btn-filter <%= filter === 'Low' ? 'active' : '' %>"><span class="priority-badge low">Low</span></a>
            </div>
        </div>

        <div class="todo-list-section">
            <h2>
                <i class="fas fa-list"></i> 
                <%= filter === 'All' ? 'All Tasks' : filter + ' Priority Tasks' %>
                <span class="task-count">(<%= todos.length %>)</span>
            </h2>

            <% if (todos.length === 0) { %>
                <div class="empty-state">
                    <i class="fas fa-inbox"></i>
                    <p>No tasks found. Add a task above!</p>
                </div>
            <% } else { %>
                <div class="todo-list">
                    <% todos.forEach(function(todo){ %>
                        <div class="todo-item" data-id="<%= todo.id %>">
                            <div class="todo-left">
                                <div class="todo-content">
                                    <span class="todo-text"><%= todo.task %></span>
                                    <span class="priority-badge <%= todo.priority.toLowerCase() %>"><%= todo.priority %></span>
                                </div>
                            </div>
                            <div class="todo-actions">
                                <button class="btn-action btn-edit" 
                                    on
